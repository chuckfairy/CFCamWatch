;(function() {"use strict";var CF=CF||{};CF.Watch={REVISION:1},CF.Watch.Dispatcher=function(){},CF.Watch.Dispatcher.prototype={constructor:CF.Watch.Dispatcher,apply:function(t){return t.on=CF.Watch.Dispatcher.prototype.on,t.hasListener=CF.Watch.Dispatcher.prototype.hasListener,t.removeListener=CF.Watch.Dispatcher.prototype.removeListener,t.dispatch=CF.Watch.Dispatcher.prototype.dispatch,t},on:function(t,n){void 0===this._listeners&&(this._listeners={});var e=this._listeners;void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(n)&&e[t].push(n)},hasListener:function(t,n){if(void 0===this._listeners)return!1;var e=this._listeners;return void 0!==e[t]&&-1!==e[t].indexOf(n)?!0:!1},removeListener:function(t,n){if(void 0!==this._listeners){var e=this._listeners,o=e[t];if(void 0!==o){var i=o.indexOf(n);-1!==i&&o.splice(i,1)}}},dispatch:function(t){if(void 0!==this._listeners){var n=this._listeners,e=n[t.type];if(void 0!==e){t.target=this;for(var o=[],i=e.length,s=0;i>s;s++)o[s]=e[s];for(var s=0;i>s;s++)o[s].call(this,t)}}}},CF.Watch.App=function(t){var n=this;n.Connection=new CF.Watch.Connection,n.UI=new CF.Watch.UI,n.init()},CF.Watch.App.prototype={constructor:CF.Watch.App,Connection:null,UI:null,init:function(){var t=this;t.setConnectionEvents(),t.setDomEvents()},setConnectionEvents:function(){var t=this;t.Connection.on("login",t.login.bind(t)),t.Connection.response("update",function(n){console.log("Cam update"),t.UI.update(n.base64)}),t.Connection.on("get-info",function(t){console.log("GET INFO",t)})},setDomEvents:function(){var t=this;t.UI.loginBtn.onclick=function(){var n=t.UI.getPassword();console.log(n),t.Connection.login(n)}},login:function(){var t=this;t.UI.hideLogin()}},CF.Watch.UI=function(){var t=this;t.imgArea=document.getElementById("img"),t.loginScreen=document.getElementById("login-screen"),t.passwordArea=document.getElementById("password"),t.loginBtn=document.getElementById("passsword-submit")},CF.Watch.UI.prototype={constructor:CF.Watch.UI,imgArea:null,loginScreen:null,passwordArea:null,loginBtn:null,update:function(t){var n=this,e=document.createElement("img");e.src=t,n.imgArea.innerHTML="",n.imgArea.appendChild(e)},hideLogin:function(){this.loginScreen.style.display="none"},getPassword:function(){return this.passwordArea.value}},CF.Watch.Connection=function(t,n){var e=this;e.app=t,e.init()},CF.Watch.Connection.prototype={io:window.io,loggedIn:!1,opts:{},socket:null,init:function(){var t=this;t.socket=t.io(),t.socket.on("login-info",t.setInfo.bind(t)),t.socket.on("login-success",t.setLogin.bind(t))},createDisplay:function(t){var n=this;return function(e){n.app.display(t,e)}},request:function(t,n){this.socket.emit(t,n)},response:function(t,n){this.socket.on(t,n)},setInfo:function(t){var n=this;t.logged&&n.setLogin(),console.log(t),n.dispatch({type:"get-info"})},setLogin:function(){var t=this;t.loggedIn=!0,t.dispatch({type:"login"})},login:function(t){var n=this;n.socket.emit("login",{pass:t})}},CF.Watch.Dispatcher.prototype.apply(CF.Watch.Connection.prototype),window.onload=function(){new CF.Watch.App};})();